<div id="<%= dom_id portfolio %>" class="card border-0">
  <div class="card-body px-0">
    <h2 class="card-title mb-4">
      <%= portfolio.name %>
    </h2>
    <% if !showDetail %>
      <p class="card-text">
        <%= portfolio.assets.map{ |asset| "#{asset.ticker} (#{asset.desired_weight.to_s}%)"}.join(" | ") %>
      </p>
    <% else %>
      <div class="row">
        <h5>Holdings</h5>
        <div class = "col">
          <div class="accordion" id="assetAccordion">
            <% portfolio.assets.each_with_index do |asset, i| %>
              <% stock = StockService.new(asset.ticker) %>
              <div class="accordion-item">
                <h5 class="accordion-header">
                  <button class="acc-btn accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse<%="#{i}"%>" aria-expanded="false" aria-controls="collapse<%="#{i}"%>" >
                    <span class="title">
                      <%= "#{stock.name} (#{asset.ticker})" %>
                    </span>
                    <strong class="price">
                      <%= sprintf("%.2f", asset.desired_weight) %>%
                    </strong>
                  </button>
                </h5>
                <div id="collapse<%="#{i}"%>" class="accordion-collapse collapse" data-bs-parent="#assetAccordion">
                  <div class="accordion-body">
                    <div class="row">
                      <span> Current Price: <%= number_to_currency(stock.price) %></span>
                    </div>
                    <div class="row">
                      <span> Quantity: <%= asset.quantity || 0.0 %> </span>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>

      <div class="row mt-5">
        <div class="col d-flex justify-content-center">
          <h5>Target Allocation</h5>
        </div>
      <div class="row">
        <div class="col">
          <%= pie_chart(portfolio.assets.map { |asset| [asset.ticker, asset.desired_weight] }, label: "Desired Allocation", height: "400px", suffix: "%", colors: @colors) %>
        </div>
      </div>
    <% end %>
  </div>
</div>